Автоматическое создание почтовых ящиков
Скрипт предназначен для автоматического создания почтовых ящиков на веб-интерфейсе почтового сервиса. Он выполняет авторизацию через двойную аутентификацию (HTTP Basic Auth + веб-форма), обрабатывает CSV-файл со списком сотрудников в формате «ФИО;email», создаёт почтовые ящики со случайно сгенерированными паролями, сохраняет результаты в Excel-отчёт created_accounts.xlsx и ведёт лог в файл mailbox_creation.log.

Структура проекта
В корневой папке находятся основной скрипт mailbox_creator.py, файл с учётными данными credentials.py (не добавляется в репозиторий), лог mailbox_creation.log, итоговый отчёт created_accounts.xlsx и CSV-файл со списком сотрудников.

Установка
Клонировать репозиторий:

bash
Копировать
Редактировать
git clone https://github.com/your-repo/mailbox_creator.git
cd mailbox_creator
Создать виртуальное окружение (по желанию):

bash
Копировать
Редактировать
python -m venv venv
source venv/bin/activate    # Linux/MacOS
venv\Scripts\activate       # Windows
Установить зависимости:

bash
Копировать
Редактировать
pip install -r requirements.txt
Если файла requirements.txt нет, используйте:

bash
Копировать
Редактировать
pip install requests openpyxl beautifulsoup4 urllib3
Настройка
В корне проекта создаётся файл credentials.py со следующими данными:

python
Копировать
Редактировать
WEB_USERNAME = "ваш_логин_для_веб"
WEB_PASSWORD = "ваш_пароль_для_веб"

BASIC_AUTH_USER = "basic_auth_user"
BASIC_AUTH_PASS = "basic_auth_pass"
Формат CSV-файла
Файл должен содержать строки вида:

scss
Копировать
Редактировать
Иванов Иван Иванович;ivanov@example.com
Петров Петр Петрович;petrov@example.com
Разделитель — точка с запятой ;, кодировка — Windows-1251 (cp1251).

Запуск
Выполнить команду:

bash
Копировать
Редактировать
python mailbox_creator.py
После выполнения создаются файлы created_accounts.xlsx и mailbox_creation.log.

Отчёт
В Excel сохраняются поля: ФИО, Email, Пароль, Дата создания, Статус. Пример:

ФИО	Email	Пароль	Дата создания	Статус
Иванов Иван	ivanov@domain.ru	AbC123xyz	2025-08-01 12:00:00	Успешно создан
Петров Петр	petrov@domain.ru		2025-08-01 12:01:00	Неверный email

Все действия логируются в mailbox_creation.log в формате:

yaml
Копировать
Редактировать
2025-08-01 12:00:00 - INFO - Успешно создан ящик ivanov@domain.ru
2025-08-01 12:01:00 - ERROR - Неверный email: petrov
Возможности
Программа поддерживает авторизацию через HTTP Basic Auth и веб-форму, многократные попытки при ошибках, генерацию случайных паролей, создание отчёта в Excel с форматированием и логирование всех операций.

Ограничения
Необходимо наличие корректного файла credentials.py, поддерживается только один CSV-файл в директории, входной файл должен быть в кодировке cp1251.

Лицензия
Проект распространяется под лицензией MIT.
