Автоматическое создание почтовых ящиков
Оглавление
1. Описание
2. Структура проекта
3. Установка
4. Настройка
5. Формат CSV-файла
6. Запуск
7. Отчёт
8. Возможности
9. Ограничения
10. Лицензия
1. Описание
Скрипт предназначен для автоматического создания почтовых ящиков на веб-интерфейсе почтового сервиса. Он выполняет авторизацию через двойную аутентификацию (HTTP Basic Auth + веб-форма), обрабатывает CSV-файл со списком сотрудников в формате «ФИО;email», создаёт почтовые ящики со случайно сгенерированными паролями, сохраняет результаты в Excel-отчёт created_accounts.xlsx и ведёт лог в файл mailbox_creation.log.
2. Структура проекта
В корневой папке находятся:
- основной скрипт mailbox_creator.py
- файл с учётными данными credentials.py (не добавляется в репозиторий)
- лог mailbox_creation.log
- итоговый отчёт created_accounts.xlsx
- CSV-файл со списком сотрудников
3. Установка
1. Клонировать репозиторий:
git clone https://github.com/your-repo/mailbox_creator.git
cd mailbox_creator
2. Создать виртуальное окружение (по желанию):
python -m venv venv
source venv/bin/activate    # Linux/MacOS
venv\Scripts\activate       # Windows
3. Установить зависимости:
pip install -r requirements.txt
Если файла requirements.txt нет, используйте:
pip install requests openpyxl beautifulsoup4 urllib3
4. Настройка
В корне проекта создаётся файл credentials.py со следующим содержимым:
WEB_USERNAME = "ваш_логин_для_веб"
WEB_PASSWORD = "ваш_пароль_для_веб"

BASIC_AUTH_USER = "basic_auth_user"
BASIC_AUTH_PASS = "basic_auth_pass"
5. Формат CSV-файла
Файл должен содержать строки вида:
Иванов Иван Иванович;ivanov@example.com
Петров Петр Петрович;petrov@example.com

Разделитель — точка с запятой (;), кодировка — Windows-1251 (cp1251).
6. Запуск
Выполнить команду:
python mailbox_creator.py
После выполнения создаются файлы created_accounts.xlsx и mailbox_creation.log.
7. Отчёт
В Excel сохраняются поля: ФИО, Email, Пароль, Дата создания, Статус. Пример:
ФИО | Email | Пароль | Дата создания | Статус
Иванов Иван | ivanov@domain.ru | AbC123xyz | 2025-08-01 12:00:00 | Успешно создан
Петров Петр | petrov@domain.ru |           | 2025-08-01 12:01:00 | Неверный email
Все действия логируются в mailbox_creation.log в формате:
2025-08-01 12:00:00 - INFO - Успешно создан ящик ivanov@domain.ru
2025-08-01 12:01:00 - ERROR - Неверный email: petrov
8. Возможности
Программа поддерживает:
- авторизацию через HTTP Basic Auth и веб-форму
- многократные попытки при ошибках
- генерацию случайных паролей
- создание отчёта в Excel с форматированием
- логирование всех операций
9. Ограничения
Необходимо наличие корректного файла credentials.py.
Поддерживается только один CSV-файл в директории.
Входной файл должен быть в кодировке cp1251.
10. Лицензия
Проект распространяется под лицензией MIT.
